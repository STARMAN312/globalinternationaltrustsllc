@model ActivityVM
@using System.Text.RegularExpressions
@{
	ViewData["Title"] = "Global International Trust Bank - Activity";
	Layout = "_ClientLayout";
}

<nav aria-label="breadcrumb">
	<ol class="breadcrumb breadcrumb-style mg-b-0">
		<li class="breadcrumb-item">
			<a>Global International Trust Bank</a>
		</li>
		<li class="breadcrumb-item active">
			<a>Activity</a>
		</li>
	</ol>
</nav>

<div class="row account-information">
	<div class="col-xl-12 col-lg-12 col-md-12 col-xs-12">
		<div class="card px-3 ps-4">
			<div class="card-body">
				<div class="mb-3">
					<button id="btnGeneratePdf" class="btn btn-primary">
						Generate PDF
					</button>
				</div>
				<div class="row index1">
					@foreach (var group in Model.Transactions
						.GroupBy(t => t.Date.Date)
						.OrderByDescending(g => g.Key))
					{

						<span class="tx-20 mt-3">
							@group.Key.ToString("dddd, MMMM dd, yyyy")
						</span>

						@foreach (var transaction in group.OrderByDescending(t => t.Date))
						{
							<div class="col-xl-12 col-lg-12 col-md-12 col-sm-12">
								<a class="row p-1 bd-t">
									<div class="col-2 d-flex align-items-center justify-content-center">
										@if (transaction.Type.ToString().Contains("Transfer") || transaction.Type.ToString() == "Withdrawal")
										{
											<div class="circle-icon bg-warning text-center align-self-center overflow-hidden shadow">
												<i class="fa fa-angle-double-up tx-15 text-white"></i>
											</div>
										}
										else if (transaction.Type.ToString() == "ServiceFee")
										{
											<div class="circle-icon bg-info text-center align-self-center overflow-hidden shadow">
												<i class="fa fa-cogs tx-15 text-white"></i>
											</div>
										}
										else
										{
											<div class="circle-icon bg-success text-center align-self-center overflow-hidden shadow">
												<i class="fa fa-angle-double-down tx-15 text-white"></i>
											</div>
										}
									</div>
									<div class="col-10">
										<div class="pt-4 pb-3">
											<div class="d-flex tx-15">
												<h6 class="mb-2">
													@Regex.Replace(transaction.AccountName, "(\\B[A-Z])", " $1")
													- @transaction.Date.ToLocalTime().ToString("HH:mm tt")
												</h6>
												@if (transaction.Type.ToString().Contains("Transfer") || transaction.Type.ToString() == "Withdrawal" || transaction.Type.ToString() == "ServiceFee")
												{
													<span class="font-weight-semibold ms-auto rounded-pill lh-maincard px-2 my-auto market-price" data-usd="@transaction.Amount" data-type="debit">
														<span class="balance-text">
															-$@transaction.Amount.ToString("N2")
														</span>
													</span>
												}
												else
												{
													<span class="font-weight-semibold ms-auto rounded-pill lh-maincard px-2 my-auto market-price" data-usd="@transaction.Amount" data-type="credit">
														<span class="balance-text">
															+$@transaction.Amount.ToString("N2")
														</span>
													</span>
												}
											</div>
											<div class="pb-0 mt-0">
												<div class="d-flex">
													<h4 class="tx-18 font-weight-semibold mb-0">@Regex.Replace(transaction.Type.ToString(), "(\\B[A-Z])", " $1")</h4>
												</div>
											</div>
										</div>
									</div>
								</a>
							</div>
						}
					}
				</div>
			</div>
		</div>
	</div>
</div>

<script>

		document.addEventListener('DOMContentLoaded', function () {
		// Parse currency info globally inside this scope
		const exchangeRates = JSON.parse(localStorage.getItem("exchangeRates") || "{}");
		const selectedCurrency = localStorage.getItem("selectedCurrency") || "USD";

		const currencySymbols = {
			USD: "$", CAD: "$", EUR: "€", GBP: "£",
			JPY: "¥", MXN: "$", KWD: "د.ك"
		};

		function formatPrice(value, currency) {
			const symbol = currencySymbols[currency] || '';
			return symbol + value.toLocaleString(undefined, { minimumFractionDigits: 2 }) + " " + currency;
		}

		function convertPrice(priceInUsd, currency) {
			if (!exchangeRates[currency] || !exchangeRates["USD"]) return priceInUsd;
			return priceInUsd * exchangeRates[currency] / exchangeRates["USD"];
		}

		// Also update all normal text prices on the page
		document.querySelectorAll('.market-price').forEach(option => {
			const balanceSpan = option.querySelector('.balance-text');
			if (!balanceSpan) return;

			const priceUsd = parseFloat(option.getAttribute('data-usd'));
			if (isNaN(priceUsd)) return;

			const type = option.getAttribute('data-type'); // read type attribute here
			let sign = "";

			const converted = convertPrice(priceUsd, selectedCurrency);
			const formatted = formatPrice(converted, selectedCurrency);

			if(type === "debit"){
				sign = "-";
			} else if(type === "credit"){
				sign = "+";
			}

			balanceSpan.textContent = sign + formatted;
		});

		document.getElementById('btnGeneratePdf').addEventListener('click', function () {
			const { jsPDF } = window.jspdf;
			
			const logoBase64 = "data:image/png;base64,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"; // your actual base64 string here

			const doc = new jsPDF();

			const logoWidth = 14;
			const logoHeight = logoWidth / 1.10; // ~27.3

			doc.addImage(logoBase64, 'PNG', 14, 10, logoWidth, logoHeight);

			doc.setFontSize(18);
			// Add title text to the right of the logo (x=50 to give space)
			doc.text("Global International Trust Bank - Transactions", 35, 19);

			let yOffset = 30;
			doc.setFontSize(12);

			// Load exchange rates and selected currency from localStorage
			const exchangeRates = JSON.parse(localStorage.getItem("exchangeRates") || "{}");
			const selectedCurrency = localStorage.getItem("selectedCurrency") || "USD";

			const currencySymbols = {
				USD: "$", CAD: "$", EUR: "€", GBP: "£",
				JPY: "¥", MXN: "$", KWD: "د.ك"
			};

			function formatPrice(value, currency) {
				const symbol = currencySymbols[currency] || '';
				return symbol + value.toLocaleString(undefined, { minimumFractionDigits: 2 }) + " " + currency;
			}

			function convertPrice(priceInUsd, currency) {
				if (!exchangeRates[currency] || !exchangeRates["USD"]) return priceInUsd;
				return priceInUsd * exchangeRates[currency] / exchangeRates["USD"];
			}

			// Grab all date headers and transaction rows
			const container = document.querySelector('.index1');
			const children = Array.from(container.children);

			let rows = [];
			let currentDate = "";

			children.forEach(child => {
				if (child.tagName === 'SPAN' && child.classList.contains('tx-20')) {
					// Date header
					if (rows.length > 0) {
						doc.text(currentDate, 14, yOffset);
						yOffset += 6;

						doc.autoTable({
							startY: yOffset,
							head: [['Account', 'Time', 'Type', 'Amount']],
							body: rows,
							theme: 'striped',
							styles: { fontSize: 10 },
							margin: { left: 14, right: 14 },
							didDrawPage: (data) => {
								yOffset = data.cursor.y + 10;
							}
						});

						rows = [];
					}
					currentDate = child.innerText.trim();
				} else if (child.tagName === 'DIV' && child.classList.contains('col-xl-12')) {
					// Transaction entry

					const accountTimeElem = child.querySelector('h6');
					let account = "", time = "";
					if (accountTimeElem) {
						const text = accountTimeElem.innerText;
						const parts = text.split(' - ');
						account = parts[0] || "";
						time = parts[1] || "";
					}

					const typeElem = child.querySelector('h4');
					const type = typeElem ? typeElem.innerText : "";

					// Original amount in USD from data-usd attribute on .market-price span
					const amountSpan = child.querySelector('.market-price');
					const amountUsd = amountSpan ? parseFloat(amountSpan.getAttribute('data-usd')) : 0;

					// Determine if debit or credit for sign
					const typeAttr = amountSpan ? amountSpan.getAttribute('data-type') : "credit";
					const sign = (typeAttr === "debit") ? "-" : "+";

					// Convert amount to selected currency
					const convertedAmount = convertPrice(amountUsd, selectedCurrency);
					const formattedAmount = sign + formatPrice(convertedAmount, selectedCurrency);

					rows.push([account, time, type, formattedAmount]);
				}
			});

			// Last group
			if (rows.length > 0) {
				doc.text(currentDate, 14, yOffset);
				yOffset += 6;
				doc.autoTable({
					startY: yOffset,
					head: [['Account', 'Time', 'Type', 'Amount']],
					body: rows,
					theme: 'striped',
					styles: { fontSize: 10 },
					margin: { left: 14, right: 14 }
				});
			}

			function getFormattedDateTime() {
				const now = new Date();
				const pad = (n) => n.toString().padStart(2, '0');

				const year = now.getFullYear();
				const month = pad(now.getMonth() + 1); // Months are zero-based
				const day = pad(now.getDate());
				const hours = pad(now.getHours());
				const minutes = pad(now.getMinutes());
				const seconds = pad(now.getSeconds());

				return `${year}${month}${day}_${hours}${minutes}${seconds}`;
			}

			// Then when saving:
			const timestamp = getFormattedDateTime();
			doc.save(`global-international-trust-bank-transactions_${timestamp}.pdf`);
		});

	});

</script>